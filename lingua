#!/usr/bin/env perl6

use lib '.';
use LinguaGrammar;
use LinguaActions;
use LinguaEvaluator;

error('Usage: ./lingua <filename>') unless @*ARGS.elems;

my $filename = @*ARGS[0];
error("Error: File $filename not found") unless $filename.IO.f;

my $code = $filename.IO.slurp();
my $ast = Lingua.parse($code, :actions(LinguaActions));
say $ast ?? 'OK' !! error('Error: parse failed');

my $eval = LinguaEvaluator.new();
$eval.eval($ast.made);

sub error($message) {
    note $message;
    exit;
}
